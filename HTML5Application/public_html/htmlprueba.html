<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IndexedDB Form Example</title>
</head>
<body>
    <h1>IndexedDB Form Example</h1>

    <form id="miFormulario">
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" name="nombre" required>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>

        <button type="button" onclick="guardarEnIndexedDB()">Guardar</button>
    </form>

    <script>
        var db;

        // Abrir o crear la base de datos
        var request = indexedDB.open("miBaseDeDatos", 1);

        // Manejar eventos de actualización de la base de datos
        request.onupgradeneeded = function(event) {
            var db = event.target.result;
            var objectStore = db.createObjectStore("miObjetoStore", { keyPath: "id", autoIncrement: true });
            objectStore.createIndex("nombre", "nombre", { unique: false });
            objectStore.createIndex("email", "email", { unique: true });
        };

        // Manejar eventos de éxito
        request.onsuccess = function(event) {
            db = event.target.result;
        };

        // Manejar eventos de error
        request.onerror = function(event) {
            console.error("Error al abrir la base de datos:", event.target.errorCode);
        };

        // Función para guardar datos en IndexedDB
        function guardarEnIndexedDB() {
            var nombre = document.getElementById("nombre").value;
            var email = document.getElementById("email").value;

            var transaction = db.transaction(["miObjetoStore"], "readwrite");
            var objectStore = transaction.objectStore("miObjetoStore");

            // Datos a guardar
            var data = { nombre: nombre, email: email };

            // Agregar datos
            var request = objectStore.add(data);

            // Manejar eventos de éxito o error
            request.onsuccess = function(event) {
                console.log("Datos agregados correctamente a IndexedDB.");
                // Puedes limpiar el formulario después de guardar los datos si es necesario
                document.getElementById("miFormulario").reset();
            };

            request.onerror = function(event) {
                console.error("Error al agregar datos a IndexedDB:", event.target.errorCode);
            };
        }
    </script>
</body>
</html>
